谷粒商城

软件：

CentOS 7 虚拟机

ifconfig 查看eth0 查看inet网站

ssh  parallels@xxx.xxx.xx.xxx

账号：parallels

密码：linhaizeng

# 环境搭建

## Docker 

[docker市场](https://hub.docker.com/)

[docker官方文档](https://docs.docker.com/)

[阿里云镜像加速器](https://cr.console.aliyun.com/cn-hangzhou/instances/mirrors)

docker 作用：

透过镜像(images)将作业系统核心除外，运作应用程式所需要的系统环境，由下而上打包，达到应用程式跨平台间的无缝接轨运作。

~~~shell
docker -v // 查看版本号
docker images // 查看镜像
sudo systemctl enable docker // 设置开机自启
~~~

### [安装docker](https://blog.csdn.net/weixin_39806100/article/details/105925731)

~~~shell
 # 移除旧版本
 sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine
 
# 设置存储库
# 安装yum-utils软件包（提供yum-config-manager 实用程序）并设置稳定的存储库。
 sudo yum install -y yum-utils    
 
#官方镜像
#sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

#阿里云镜像
sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo 

# 安装docker引擎
sudo yum install docker-ce docker-ce-cli containerd.io

# 启动docker
#启动
sudo systemctl start docker

#停止
sudo systemctl stop docker

#重启		
sudo service docker restart

#开机启动
sudo systemctl enable docker

# 配置阿里云镜像加速器
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": ["https://5fjqeuna.mirror.aliyuncs.com"]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker

# 其他源
[root@localhost]# vim /etc/docker/daemon.json  # 创建或修改 /etc/docker/daemon.json 文件，修改为如下形式
{
    "registry-mirrors" : [
    "https://registry.docker-cn.com",
    "https://docker.mirrors.ustc.edu.cn",
    "http://hub-mirror.c.163.com",
    "https://cr.console.aliyun.com/"
  ]
}
~~~

### Docker安装镜像

#### 安装mysql

~~~shell
# 安装5.7版本的mysql
sudo docker pull mysql:5.7

sudo docker pull mysql:5.7

# --name指定容器名字 -v目录挂载 -p指定端口映射  -e设置mysql参数 -d后台运行
# -p A:B A 代表外部linux端口;  B代表内部容器端口
# -v A:B A 代表linux ; B代表docker容器
sudo docker run -p 3306:3306 --name mysql \
-v /mydata/mysql/log:/var/log/mysql \
-v /mydata/mysql/data:/var/lib/mysql \
-v /mydata/mysql/conf:/etc/mysql \
-e MYSQL_ROOT_PASSWORD=root \
-d mysql:5.7

# 查看docker镜像
[root@localhost vagrant]# docker ps
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES
6a685a33103f        mysql:5.7           "docker-entrypoint.s…"   32 seconds ago      Up 30 seconds       0.0.0.0:3306->3306/tcp, 33060/tcp   mysql

# 进入已启动的容器
docker exec -it mysql bin/bash
# 退出进入的容器
exit;

因为有目录映射，所以我们可以直接在镜像外执行
vi /mydata/mysql/conf/my.conf 

## 复制以下内容 begin
[client]
default-character-set=utf8
[mysql]
default-character-set=utf8
[mysqld]
init_connect='SET collation_connection = utf8_unicode_ci'
init_connect='SET NAMES utf8'
character-set-server=utf8
collation-server=utf8_unicode_ci
skip-character-set-client-handshake
skip-name-resolve
## end
# 保存(注意评论区该配置不对，不是collection而是collation)

# 重启mysql
docker restart mysql

~~~

#### 安装redis

~~~shell
# 下载镜像文件，默认最新版本
docker pull redis

# 在虚拟机中 redis中默认没有redis.conf
mkdir -p /mydata/redis/conf
touch /mydata/redis/conf/redis.conf


docker run -p 6379:6379 --name redis \
-v /mydata/redis/data:/data \
-v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \
-d redis redis-server /etc/redis/redis.conf

# 直接进去redis客户端。
docker exec -it redis redis-cli

~~~

持久化数据，评论区说新版本redis 默认持久化了

~~~shell
# 持久化数据
vim /mydata/redis/conf/redis.conf
# 插入下面内容
appendonly yes
# 保存

docker restart redis
~~~

notes：云服务器需要设置redis 密码

### Docker开机启动

~~~shell
sudo docker ps
sudo docker ps -a
# 这两个命令的差别就是后者会显示  【已创建但没有启动的容器】

# 我们接下来设置我们要用的容器每次都是自动启动
sudo docker update redis --restart=always
sudo docker update mysql --restart=always
# 如果不配置上面的内容的话，我们也可以选择手动启动
sudo docker start mysql
sudo docker start redis
# 如果要进入已启动的容器
sudo docker exec -it mysql /bin/bash
# /bin/bash就是进入一般的命令行，如果改成redis就是进入了redis

~~~



## 开发工具

### maven

在settings中配置阿里云镜像，配置jdk1.8。这个基本都配置过，不贴了

### IDEA

安装插件lombok，mybatisX。IDEA设置里配置好maven

### vsCode

下载vsCode用于前端管理系统。在vsCode里安装插件。

- Auto Close Tag
- Auto Rename Tag
- Chinese
- ESlint
- HTML CSS Support
- HTML Snippets
- JavaScript ES6
- Live Server
- open in brower
- Vetur
  

### Git

~~~shell
# 配置用户名
git config --global user.name "username"  //(名字，随意写)

# 配置邮箱
git config --global user.email "55333@qq.com" // 注册账号时使用的邮箱

# 配置ssh免密登录
ssh-keygen -t rsa -C "55333@qq.com"
三次回车后生成了密钥：公钥私钥
cat ~/.ssh/id_rsa.pub

# 也可以查看密钥
# 浏览器登录码云后，个人头像上点设置--ssh公钥---随便填个标题---复制
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC6MWhGXSKdRxr1mGPZysDrcwABMTrxc8Va2IWZyIMMRHH9Qn/wy3PN2I9144UUqg65W0CDE/thxbOdn78MygFFsIG4j0wdT9sdjmSfzQikLHFsJ02yr58V6J2zwXcW9AhIlaGr+XIlGKDUy5mXb4OF+6UMXM6HKF7rY9FYh9wL6bun9f1jV4Ydlxftb/xtV8oQXXNJbI6OoqkogPKBYcNdWzMbjJdmbq2bSQugGaPVnHEqAD74Qgkw1G7SIDTXnY55gBlFPVzjLWUu74OWFCx4pFHH6LRZOCLlMaJ9haTwT2DB/sFzOG/Js+cEExx/arJ2rvvdmTMwlv/T+6xhrMS3 553736044@qq.com

# 测试
ssh -T git@gitee.com
测试成功，就可以无密给码云推送仓库了
~~~

## 创建项目微服务

首先在Git上创建项目Gulimall，添加.gitignore 为maven，选择开源许可证为apache-2.0

~~~java
group:com.atguigu.gulimall
Artifact: gulimall-product
package:com.atguigu.gulimall.product
选择Web ->springweb
  Spring Cloud Routing ->OpenFeign
~~~
依次创建出以下服务模块
~~~java
商品服务product
存储服务ware
订单服务order
优惠券服务coupon
用户服务member
  
共同点：
导入web和openFeign
group：com.atguigu.gulimall
Artifact：gulimall-XXX
每一个服务，包名com.atguigu.gulimall.XXX{product/order/ware/coupon/member}
模块名：gulimall-XXX

~~~

